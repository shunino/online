webpackJsonp([20],{146:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var o=i(0),n=(i.n(o),i(21));t.default={mixins:[n.a],data:function(){return{pointArr:[],map:{},searchParams:{provinceId:"",name:""}}},beforeRouteEnter:function(e,t,i){i(function(e){e.initMap(),e.updataStatus()})},beforeRouteLeave:function(e,t,i){var o=localStorage.getItem("tel"),n=this.myBrowser(),a=this.getCookie("UM_distinctid"),r=localStorage.getItem("ip"),s=this.osType(),c=localStorage.getItem("enter_time"),p=new Date;p=this.formatTime(p);var l=window.location.host+e.path,d=window.location.href;d.indexOf("?")>0&&(d=d.substr(0,d.indexOf("?")));this.common.request.logPost("/addLog",{logtype:"mobile_visit_time",user_id:o||null,user_agent:n,cookie:a,ip_addr:r,os_type:s,enter_url:l,leave_url:d,enter_time:c,leave_time:p,version:"3.0.0"}).then(function(e){}),i(),this.searchParams.provinceId="",this.searchParams.name=""},created:function(){},mounted:function(){var e=localStorage.getItem("tel"),t=this.myBrowser(),i=this.getCookie("UM_distinctid"),o=localStorage.getItem("ip"),n=new Date;n=this.formatTime(n),localStorage.enter_time=n;var a=this.osType(),r=document.location.href;this.common.request.logPost("/addLog",{logtype:"mobile_visit",user_id:e||null,user_agent:t,cookie:i,ip_addr:o,os_type:a,present_url:r,record_time:n,version:"3.0.0"}).then(function(e){})},methods:{updataStatus:function(){document.title="地图找房"},initMap:function(){this.map=new BMap.Map("container"),this.map.centerAndZoom(new BMap.Point(103.554332,38.977962),4),this.map.enableScrollWheelZoom(),this.map.setMapStyle({styleJson:[{featureType:"road",elementType:"all",stylers:{visibility:"off"}},{featureType:"administrative",elementType:"all",stylers:{visibility:"off"}},{featureType:"boundary",elementType:"all",stylers:{visibility:"off"}},{featureType:"water",elementType:"all",stylers:{visibility:"off"}}]}),this.getProvincePoint(),this.addDistrict(this.map,"中国",!0,"#FFF","#DDD")},addDistrict:function(e,t,i,o,n){var a=[],r=0;r++,(new BMap.Boundary).get(t,function(s){var c=s.boundaries.length;if(0!==c){for(var p=0;p<c;p++)a.push({points:s.boundaries[p],name:t});if(0==--r){var l=[],d={lat:79,lng:13},u={lat:79,lng:166},m={lat:1,lng:166},h={lat:-1,lng:13},f=[];f.push(m),f.push(u),f.push(d),f.push(h),f.push(m);for(var p=0;p<a.length;p++)if(0==i||0==p||9==p){var g=new BMap.Polygon(a[p].points,{strokeWeight:1,strokeColor:"#000000",fillOpacity:.6,fillColor:o});e.addOverlay(g);var v=g.getPath();l=l.concat(v),f=f.concat(v),f.push(f[0])}new BMap.Polygon(f,{strokeOpacity:1e-7,strokeColor:"#000000",strokeWeight:1e-5,fillColor:n,fillOpacity:1})}}})},getProvincePoint:function(e){var t=this;t.pointArr=[],this.common.request.get("/home/provinceListForMap",{}).then(function(e){for(var i=0;i<e.length;i++){var o;!function(i){var n=e[i].provinceName,a=e[i].provinceId;o=new BMap.Geocoder,o.getPoint(n,function(e){t.pointArr.push({x:e.lng,y:e.lat,provincename:n,provinceId:a})},n)}(i)}}),this.showProviceArea(t.pointArr,e)},showProviceArea:function(t,i){var o=this;setTimeout(function(){var n=localStorage.addressx,a=localStorage.addressy,r=new BMap.Point(n,a);(new BMap.Geocoder).getLocation(r,function(n){var a=n.addressComponents;i=a.province;for(var r=0;r<t.length;r++){var s=new BMap.Point(t[r].x,t[r].y),c=t[r].provincename,p={position:s,offset:new BMap.Size(-20,-73)};"内蒙古自治区"==c&&(c=c.replace("古自治区","")),"广西壮族自治区"==c&&(c=c.replace("壮族自治区","")),"西藏自治区"==c&&(c=c.replace("自治区","")),"宁夏回族自治区"==c&&(c=c.replace("回族自治区","")),"新疆维吾尔自治区"==c&&(c=c.replace("维吾尔自治区","")),c=c.replace("省",""),c=c.replace("市","");var l=new BMap.Label(c,p),d={color:"#FFF",fontSize:"12px",background:"url(/static/mark1.png) no-repeat",width:"42px",height:"46px",fontFamily:"微软雅黑",maxWidth:"inherit",paddingTop:"10px",border:"0",textAlign:"center"};i==t[r].provincename&&(d={color:"#FFF",fontSize:"20px",background:"url(/static/mark2.png) no-repeat",width:"66px",height:"69px",fontFamily:"微软雅黑",maxWidth:"inherit",paddingTop:"20px",border:"0",textAlign:"center"}),l.setStyle(d),l.proviceId=t[r].provinceId,o.map.addOverlay(l),l.addEventListener("click",function(){var t=e(this)[0].proviceId,i=e(this)[0].content;o.getCityPoint(t,i)})}})},600)},goList:function(){this.$router.go(-1)},goPage:function(){this.$router.push("/building")},getCityPoint:function(t,i){var o=this;o.map.clearOverlays(),this.addDistrict(o.map,i,!1,"#888","#DDD"),o.common.request.post("/home/cityListForMap",{provinceId:t}).then(function(n){for(var a=[],r=0;r<n.length;r++){var s;!function(e){var t=n[e].cityName,i=n[e].cityId,o=n[e].projectList;s=new BMap.Geocoder,s.getPoint(t,function(e){a.push({x:e.lng,y:e.lat,cityName:t,cityId:i,cityList:o})},t)}(r)}setTimeout(function(){o.map.centerAndZoom(i,7);for(var n=0;n<a.length;n++){var r=a[n].cityList,s="";if(r.length>3){r.length=3;for(var c=0;c<r.length;c++)s+="<div>"+r[c].projectName+"</div>";s+="<div>查看更多楼盘></div>"}else for(var p=0;p<r.length;p++)s+="<div>"+r[p].projectName+"</div>";var l="<div>"+a[n].cityName+s+"</div><div style='float: left;position: absolute;margin-left: -11px;margin-top: -2px;'><img src='/static/qipao_r.png'/></div>",d=new BMap.Point(a[n].x,a[n].y),u={position:d,offset:new BMap.Size(-90,-73)},m=new BMap.Label(l,u);m.cityName=a[n].cityName,m.setStyle({color:"#111",fontSize:"12px",backGround:"#fff",height:"auto",lineHeight:"18px",fontFamily:"微软雅黑",padding:"12px 10px 5px 10px",border:"1px solid #fff",maxWidth:"none",textAlign:"center",width:"140px",borderRadius:"10px"}),m.cityId=a[n].cityId,o.map.addOverlay(m),m.addEventListener("click",function(){var t=e(this)[0].cityId,i=e(this)[0].cityName;localStorage.cityid=t,localStorage.cityname=i,o.$router.push("/buildinglist")}),o.searchParams.provinceId=t}},500)})},inputFocus:function(t){t?e(".menu").hide():e(".menu").show()},search:function(t){var n=this;e(".BMapLabel").each(function(e,t){n.searchParams.provinceId||(t.style.width="42px",t.style.height="46px",t.style.fontSize="12px",t.style.paddingTop="10px",t.style.background="url(/static/mark1.png) no-repeat")}),this.common.request.post("/home/findForMap",this.searchParams).then(function(t){t&&t.length>0?e.each(t,function(t,i){e(".BMapLabel").each(function(e,t){n.searchParams.provinceId||(n.searchParams.name?i.provinceName.indexOf(t.innerText)>-1&&(t.style.background="url(/salesportal/wechat/static/mark2.png) no-repeat",t.style.width="66px",t.style.height="69px",t.style.fontSize="20px",t.style.paddingTop="20px",t.style["background-size"]="66px 69px"):t.style.background="url(/static/mark1.png) no-repeat")})}):i.i(o.Toast)("未查询到楼盘")})}},components:{}}}.call(t,i(3))},165:function(e,t,i){t=e.exports=i(55)(!1),t.i(i(212),""),t.push([e.i,"",""])},212:function(e,t,i){t=e.exports=i(55)(!1),t.push([e.i,"#container,.map{height:100%;width:100%}#map-holder{width:100%;height:calc(100% - .5rem)}#map-holder div.anchorBL{display:none!important}.map-summary{position:fixed;width:100%;z-index:3;left:0;bottom:.5rem;line-height:.4rem;font-size:.14rem;background:hsla(0,0%,100%,.8)}.map-summary span{padding:0 .05rem;color:#ff8518}.map-filter{position:fixed;top:0;height:.6rem;width:100%;line-height:.4rem;padding:.1rem;background:#fcfcfc;box-sizing:border-box}.map-filter img{width:.22rem;height:.22rem;border-radius:2px;position:relative;top:-1px}.map-filter input{width:calc(100% - .95rem);margin:0 .1rem;-webkit-appearance:none;border:none;border-radius:5px;opacity:.8;height:.2rem;line-height:.2rem;padding:.09rem 0;box-sizing:initial;border:1px solid #d3d3d3}.map-filter input::placeholder{color:#999}",""])},229:function(e,t,i){var o=i(165);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);i(56)("5ba67fed",o,!0)},297:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAPFBMVEUAAAA/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur0/ur3sRLu0AAAAE3RSTlMAZjOl8c1eH+SXin5yQjsZCb+708f84gAAAFVJREFUOMvlkjkOgDAMBDeQgzMc+/+/0loushWkYOqRLHuMP5FjOrAHhxEiuWKkwwiJzE2hLAG9qdd8ogwOI0zk1tpCC/UWI95CnlrGkrnVw/QP/CEPNQMJzEIRJGUAAAAASUVORK5CYII="},323:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"map"},[o("div",{attrs:{id:"container"}}),e._v(" "),o("div",{staticClass:"map-filter"},[o("span",{staticStyle:{color:"#00B96D",float:"left","font-size":"0.15rem"},on:{click:function(t){e.goList()}}},[e._v("列表\n\t\t    "),o("img",{attrs:{src:i(297)}})]),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.searchParams.name,expression:"searchParams.name"}],staticClass:"map-search text-center",attrs:{type:"search",placeholder:"输入楼盘名称"},domProps:{value:e.searchParams.name},on:{keyup:function(t){if(!("button"in t)&&13!==t.keyCode)return null;e.search()},focus:function(t){e.inputFocus(!0)},focusout:function(t){e.inputFocus(!1)},input:function(t){t.target.composing||e.$set(e.searchParams,"name",t.target.value)}}})])])},staticRenderFns:[]}},76:function(e,t,i){function o(e){i(229)}var n=i(7)(i(146),i(323),o,"data-v-1376ef79",null);e.exports=n.exports}});